name: "Test Draft Rule - Suspicious Attachment"
description: "Test rule for draft PR functionality - detects suspicious attachment patterns"
type: "rule"
severity: "medium"
authors:
  - github.com/aidenmitchell
source: |
  type.inbound
  and any(attachments,
      .file_extension in~ ("exe", "scr", "bat", "cmd")
      and .file_type == "unknown"
  )
tags:
  - "Attack surface reduction"
attack_types:
  - "Malware/Ransomware"
tactics_and_techniques:
  - "T1204"
detection_methods:
  - "File analysis"
